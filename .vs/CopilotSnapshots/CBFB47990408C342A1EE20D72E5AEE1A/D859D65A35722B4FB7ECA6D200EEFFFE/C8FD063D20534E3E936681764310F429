using BusinessObjects;
using Repositories;
using System;
using System.Collections.Generic;

namespace Services
{
    public class CustomersService
    {
        private readonly ICustomersRepository _customersRepository;

        public CustomersService()
        {
            _customersRepository = new CustomersRepository();
        }

        public List<Customers> GetAllCustomers()
        {
            return _customersRepository.GetCustomers();
        }

        public Customers GetCustomerById(int id)
        {
            return _customersRepository.GetCustomerById(id);
        }

        public Customers GetCustomerByPhone(string phone)
        {
            return _customersRepository.GetCustomerByPhone(phone);
        }

        public void AddCustomer(Customers customer)
        {
            if (customer == null)
                throw new ArgumentNullException(nameof(customer));

            _customersRepository.AddCustomer(customer);
        }

        public void UpdateCustomer(Customers customer)
        {
            if (customer == null)
                throw new ArgumentNullException(nameof(customer));

            _customersRepository.UpdateCustomer(customer);
        }

        public void DeleteCustomer(int customerId)
        {
            _customersRepository.DeleteCustomer(customerId);
        }

        public List<Customers> SearchCustomers(string searchTerm)
        {
            return _customersRepository.SearchCustomers(searchTerm);
        }
    }
}
